# üß™ MySQL Database Initialization Guide

**Project:** Laboratory System  
**Date:** 2025-10-31  
**Author:** Generated by ChatGPT

---

## üìò Overview

This document explains the full process for creating and initializing the **MySQL database** for the laboratory management system.  
It includes the structure, order of execution, and optional improvements to ensure a clean and efficient setup.

---

## üß± 1Ô∏è‚É£ Database Schema (`01_schema.sql`)

### ‚úÖ Description
This file creates the **database** and all **main tables** required by the system.

```sql
CREATE DATABASE IF NOT EXISTS lab_db_sql
  CHARACTER SET utf8mb4
  COLLATE utf8mb4_general_ci;

USE lab_db_sql;
```

### üß© Tables Created
1. LabStaff  
2. Patient  
3. MedicalStudy  
4. Talon  
5. DoctorAppointment  
6. DoctorAppointment_MedicalStudy  
7. Orden  
8. Orden_MedicalStudy  
9. Result  
10. PaymentMethod  
11. Payment

Each table includes foreign key constraints, timestamps, and ENUM definitions for consistent data control.

---

## üí° 2Ô∏è‚É£ Recommended Improvements

### A) Consistent Naming
Keep the `_id` pattern for all primary and foreign keys for clarity.

### B) Foreign Key Constraints
Ensure `NOT NULL` only when the relation is mandatory (for example, `patient_id` in `DoctorAppointment`).

### C) Suggested Indexes
If not included in `02_indexes.sql`, add the following for performance:

```sql
CREATE INDEX idx_patient_dni ON Patient(dni);
CREATE INDEX idx_labstaff_role ON LabStaff(role);
CREATE INDEX idx_result_status ON Result(status);
CREATE INDEX idx_doctorappointment_status ON DoctorAppointment(status);
```

---

## ‚öôÔ∏è 3Ô∏è‚É£ Execution Order

| Order | File | Description |
|:------:|:------------------|:--------------------------------------|
| 1Ô∏è‚É£ | `01_schema.sql` | Create database and all tables |
| 2Ô∏è‚É£ | `02_indexes.sql` | Create additional indexes |
| 3Ô∏è‚É£ | `03_views.sql` | Define database views |
| 4Ô∏è‚É£ | `04_procedures.sql` | Create stored procedures |
| 5Ô∏è‚É£ | `05_triggers.sql` | Define triggers |
| 6Ô∏è‚É£ | `06_roles.sql` | Create users, roles, and permissions |
| 7Ô∏è‚É£ | `07_seed.sql` | Insert minimal seed data |
| 8Ô∏è‚É£ | `08_full_seed.sql` | Load full data from CSV files |

---

## üß∞ 4Ô∏è‚É£ Initialization Script (Optional)

To automate all steps, create an **init.sql** file:

```sql
SOURCE /init/script/01_schema.sql;
SOURCE /init/script/02_indexes.sql;
SOURCE /init/script/03_views.sql;
SOURCE /init/script/04_procedures.sql;
SOURCE /init/script/05_triggers.sql;
SOURCE /init/script/06_roles.sql;
SOURCE /init/script/07_seed.sql;
SOURCE /init/script/08_full_seed.sql;
```

---

## üê≥ 5Ô∏è‚É£ Docker Integration

To run this automatically using Docker, add this line under your MySQL service in `docker-compose.yml`:

```yaml
volumes:
  - ./init/script:/docker-entrypoint-initdb.d
```

This allows MySQL to execute the SQL files automatically on container startup.

---

## üßæ 6Ô∏è‚É£ Notes

- Ensure all `.csv` files exist under `init/data/` for seed operations.  
- Use UTF-8 encoding for CSVs to avoid character issues.  
- The execution order must be respected to avoid foreign key errors.

---

## ‚úÖ Summary

This setup provides a modular and clean initialization workflow for your **lab management MySQL database**, ensuring consistent structure, data integrity, and easy maintenance.

---

¬© 2025 Laboratory System Database Setup Guide
